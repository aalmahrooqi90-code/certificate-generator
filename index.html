<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>مولد الشهادات</title>
<style>
    body {
        font-family: 'Amiri', serif;
        text-align: center;
        direction: rtl;
        background: #f8f8f8;
    }
    #certificateCanvas {
        border: 1px solid #ccc;
        margin-top: 20px;
    }
    input {
        font-size: 18px;
        padding: 10px;
        width: 300px;
        margin-top: 20px;
    }
    button {
        font-size: 18px;
        padding: 10px 20px;
        margin: 10px;
        cursor: pointer;
    }
</style>
</head>
<body>
<h1>مولد الشهادات</h1>
<p>أدخل اسمك للحصول على الشهادة</p>
<input type="text" id="nameInput" placeholder="اكتب اسمك هنا">
<br>
<button onclick="generateCertificate()">إنشاء الشهادة</button>
<button onclick="downloadCertificate()">تحميل الشهادة</button>
<br>
<canvas id="certificateCanvas" width="714" height="504"></canvas>

<script>
const canvas = document.getElementById('certificateCanvas');
const ctx = canvas.getContext('2d');

// تحميل صورة الشهادة
const certificateImage = new Image();
certificateImage.src = 'certificate-template.png'; // ضع اسم الصورة هنا
certificateImage.onload = () => {
    ctx.drawImage(certificateImage, 0, 0, canvas.width, canvas.height);
};

function generateCertificate() {
    const userName = document.getElementById('nameInput').value.trim();
    if (!userName) {
        alert('يرجى إدخال الاسم');
        return;
    }

    // إعادة رسم الصورة
    ctx.drawImage(certificateImage, 0, 0, canvas.width, canvas.height);

    // إعدادات النص
    const fontFamily = 'Amiri';
    const fontColor = '#2c3e50';
    let fontSize = 42; // الحجم الابتدائي

    // الإحداثيات الدقيقة
    const textXPosition = canvas.width / 2; // منتصف الشهادة
    const textYPosition = canvas.height * 0.42; // السطر الفارغ أسفل العبارة الأولى

    // حساب الحجم الديناميكي
    const maxWidth = canvas.width * 0.6; // المساحة المسموح بها (60% من العرض)
    do {
        ctx.font = `${fontSize}px ${fontFamily}`;
        var textWidth = ctx.measureText(userName).width;
        if (textWidth > maxWidth) {
            fontSize -= 2; // قلل الحجم تدريجيًا
        }
    } while (textWidth > maxWidth && fontSize > 20); // لا يقل عن 20px

    // رسم النص
    ctx.font = `${fontSize}px ${fontFamily}`;
    ctx.fillStyle = fontColor;
    ctx.textAlign = 'center';
    ctx.fillText(userName, textXPosition, textYPosition);
}

function downloadCertificate() {
    const link = document.createElement('a');
    link.download = 'شهادتي.png';
    link.href = canvas.toDataURL();
    link.click();
}
</script>
</body>
